Important Considerations for Reaction Rates
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When a molecule has multiple interfaces, such as `A(a,b)`, and can bind to itself using distinct interfaces (e.g., `A(a) + A(b) <-> A(a!1).A(b!1)`), the `ka3D` values are read such that `KD = kb / ka3D`, with no automatic re-scaling. This is suitable for molecules like Actin, which bind to themselves using two distinct interfaces (e.g., `A(barbed end) + A(pointed end) ->`). However, for models like clathrin, where the distinction between an `a` site and a `b` site is purely a label to distinguish their coordinates in space, and all interactions are possible (e.g., `A(a) + A(a) ->`, `A(a) + A(b) ->`, `A(b) + A(b) ->`), users should input rates multiplied by two for these specific cases. For example:

- `A(a) + A(a) <-> A(a!1).A(a!1)` with `onRate3Dka = 1`
- `A(a) + A(b) <-> A(a!1).A(b!1)` with `onRate3Dka = 2`

The rate for the true self-interaction (i.e., `onRate3Dka = 1` in the example above) corresponds to the `KD` given all identical sites. If this adjustment is not made, and the same rates are used for `A(a) + A(a)` binding as for `A(a) + A(b)` binding, the equilibrium will not match the thermodynamic expectations. This is also discussed in Ref. 2 and applies to all rule-based, rate-based reactions (noted in NFSim, where self-rates are automatically divided by 2). The goal is to have `2 * A(a!).A(a!) = A(a!).A(b!) = A(a!).A(c!)`, ensuring that each product/complex type has the same number of `a` sites bound, due to having the same binding free energy. This result emerges from the combinatorics of choosing two of the same molecules from `Atot = N0`, versus one molecule `A` from `Atot = N0` and one molecule `B` from `Btot = N0`. They produce an identical equilibrium with the same number of `A` in bound states when `Aeqself(KD) = Aeqdistinct(KD/2) = Beqdistinct(KD/2)`.

As described in the NERDSS paper, the reaction rates are input by the user as the 3D values, `ka3D`, and the code will convert them to the values needed for the appropriate reaction kinetics. We always have that `KD = kb / ka3D = koff / kon3D`, based on the user-input rates. For information on the rates needed to give to the Greenâ€™s function to recover appropriate reaction kinetics, see Ref. 2, SI.
